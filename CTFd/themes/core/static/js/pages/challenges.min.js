!function(i){function e(e){for(var t,a,n=e[0],l=e[1],o=e[2],s=0,d=[];s<n.length;s++)a=n[s],Object.prototype.hasOwnProperty.call(c,a)&&c[a]&&d.push(c[a][0]),c[a]=0;for(t in l)Object.prototype.hasOwnProperty.call(l,t)&&(i[t]=l[t]);for(f&&f(e);d.length;)d.shift()();return u.push.apply(u,o||[]),r()}function r(){for(var e,t=0;t<u.length;t++){for(var a=u[t],n=!0,l=1;l<a.length;l++){var o=a[l];0!==c[o]&&(n=!1)}n&&(u.splice(t--,1),e=s(s.s=a[0]))}return e}var a={},c={3:0},u=[];function s(e){if(a[e])return a[e].exports;var t=a[e]={i:e,l:!1,exports:{}};return i[e].call(t.exports,t,t.exports,s),t.l=!0,t.exports}s.m=i,s.c=a,s.d=function(e,t,a){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)s.d(a,n,function(e){return t[e]}.bind(null,n));return a},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/themes/core/static/js";var t=(n=window.webpackJsonp=window.webpackJsonp||[]).push.bind(n);n.push=e;for(var n=n.slice(),l=0;l<n.length;l++)e(n[l]);var f=t;u.push(["./CTFd/themes/core/assets/js/pages/challenges.js",0,1]),r()}({"./CTFd/themes/core/assets/js/pages/challenges.js":function(e,t,a){a("./CTFd/themes/core/assets/js/pages/main.js"),a("./node_modules/bootstrap/js/dist/tab.js");var n=a("./CTFd/themes/core/assets/js/ezq.js"),i=a("./CTFd/themes/core/assets/js/utils.js"),r=s(a("./node_modules/dayjs/dayjs.min.js")),l=s(a("./node_modules/dayjs/plugin/relativeTime.js")),g=s(a("./node_modules/jquery/dist/jquery.js")),c=s(a("./CTFd/themes/core/assets/js/CTFd.js")),o=s(a("./CTFd/themes/core/assets/js/config.js")),u=s(a("./node_modules/highlight.js/lib/index.js")),a=a("./node_modules/event-source-polyfill/src/eventsource.js");function s(e){return e&&e.__esModule?e:{default:e}}var f=a.NativeEventSource||a.EventSourcePolyfill;r.default.extend(l.default),c.default._internal.challenge={};function h(e){var t=(0,g.default)("#control-error").length?(0,g.default)("#control-error"):(0,g.default)('<span id="control-error"></span>').appendTo("#challenge-control");return t.text(e),t}function p(){h("")}var v=[],m=[],b=function(t){var e=g.default.grep(v,function(e){return e.id==t})[0];"hidden"!==e.type?d(e):(0,n.ezAlert)({title:"Challenge Hidden!",body:"You haven't unlocked this challenge yet!",button:"Got it!"})},w=function(e,t){c.default.fetch("/api/v1/challenges/".concat(e,"/k8s")).then(function(e){return e.json()}).then(function(e){if(!e.success)throw new Error(e.data.message);t(e.data.k8s_state)}).catch(function(e){h(e)})},d=function(d){return Promise.all([c.default.api.get_challenge({challengeId:d.id}),g.default.getScript(o.default.urlRoot+d.script),g.default.get(o.default.urlRoot+d.template)]).then(function(e){var t=c.default._internal.challenge;(0,g.default)("#challenge-window").empty(),t.data=e[0].data,t.preRender(),(0,g.default)("#challenge-window").append(e[0].data.view),(0,g.default)("#challenge-window #challenge-input").addClass("form-control"),(0,g.default)("#challenge-window #challenge-submit").addClass("btn btn-md btn-outline-secondary float-right");var o,s,a=(0,g.default)("#challenge-window").find(".modal-dialog");if(window.init.theme_settings&&window.init.theme_settings.challenge_window_size)switch(window.init.theme_settings.challenge_window_size){case"sm":a.addClass("modal-sm");break;case"lg":a.addClass("modal-lg");break;case"xl":a.addClass("modal-xl")}(0,g.default)(".challenge-solves").click(function(e){k((0,g.default)("#challenge-id").val())}),(0,g.default)(".nav-tabs a").click(function(e){e.preventDefault(),(0,g.default)(this).tab("show")}),(0,g.default)("#challenge-window").on("hide.bs.modal",function(e){var t=(0,g.default)(this).data("eventSource");t&&t.close(),(0,g.default)("#challenge-input").removeClass("wrong"),(0,g.default)("#challenge-input").removeClass("correct"),(0,g.default)("#incorrect-key").slideUp(),(0,g.default)("#correct-key").slideUp(),(0,g.default)("#already-solved").slideUp(),(0,g.default)("#too-fast").slideUp()}),(0,g.default)(".load-hint").on("click",function(e){S((0,g.default)(this).data("hint-id"))}),(0,g.default)("#challenge-submit").click(function(e){e.preventDefault(),(0,g.default)("#challenge-submit").addClass("disabled-button"),(0,g.default)("#challenge-submit").prop("disabled",!0),c.default._internal.challenge.submit().then(y).then(_).then(C).then(j)}),t.data.kubernetes_enabled&&(o=function(e){(0,g.default)(e).attr("disabled","true"),(0,g.default)(e).find("i").removeAttr("class").addClass("fas").addClass("fa-circle-notch").addClass("fa-spin")},s=function(e,t){(0,g.default)(e).removeAttr("disabled"),(0,g.default)(e).find("i").removeClass("fa-circle-notch").removeClass("fa-spin").addClass("fas").addClass(t)},w(d.id,function(e){function t(e){switch(e.state){case"stopped":s(n,"fa-play"),n.show(),l.hide(),(0,g.default)("#connection-overview").remove();break;case"starting":o(n),n.show(),l.hide(),(0,g.default)("#connection-overview").remove();break;case"started":var a,t;s(l,"fa-stop"),n.hide(),l.show(),e.exposed&&((0,g.default)("#connection-overview").find("ul").remove(),a=(0,g.default)("<ul></ul>"),e.exposed.forEach(function(e){var t=e.host,e=e.port;(0,g.default)("<li></li>").text("".concat(t,":").concat(e)).appendTo(a)}),t=(0,g.default)('<div id="connection-overview"><br /><span>Your challenge is reachable on:</span></div>'),a.appendTo(t),t.appendTo("#challenge-control"));break;case"stopping":n.hide(),o(l),l.show(),(0,g.default)("#connection-overview").remove();break;default:throw"Unknown state"}j()}var n=(0,g.default)('<button id="challenge-start"><i class="fas fa-play"></i>&nbsp;Start the challenge</button>').on("click",function(){var t=this;p(),o(this),c.default.fetch("/api/v1/challenges/".concat(d.id,"/k8s"),{method:"POST"}).then(function(e){return e.json()}).then(function(e){if(!e.success)throw Error(e.data.message)}).catch(function(e){s(t,"fa-play"),h("There was an error starting the challenge: ".concat(e))})}),l=(0,g.default)('<button id="challenge-stop"><i class="fas fa-stop"></i>&nbsp;Stop the challenge</button>').on("click",function(){var t=this;p(),o(this),c.default.fetch("/api/v1/challenges/".concat(d.id,"/k8s"),{method:"DELETE"}).then(function(e){return e.json()}).then(function(e){if(!e.success)throw Error(e.data.message)}).catch(function(e){s(t,"fa-stop"),h("There was an error starting the challenge: ".concat(e))})});l.prependTo("#challenge-control"),n.prependTo("#challenge-control"),t(e);e=new f("/api/v1/challenges/".concat(d.id,"/k8s"));(0,g.default)("#challenge-window").data("eventSource",e),e.onmessage=function(e){try{if(k8sEvent=JSON.parse(e.data),!k8sEvent.state)throw Error("Invalid state format received from k8s status: ".concat(JSON.stringify(e.data)));t(k8sEvent)}catch(e){}}})),(0,g.default)("#challenge-input").keyup(function(e){13==e.keyCode&&(0,g.default)("#challenge-submit").click()}),t.postRender(),(0,g.default)("#challenge-window").find("pre code").each(function(e){u.default.highlightBlock(this)}),window.location.replace(window.location.href.split("#")[0]+"#".concat(d.name,"-").concat(d.id)),(0,g.default)("#challenge-window").modal()})};function y(e){var t=e.data,a=(0,g.default)("#result-message"),e=(0,g.default)("#result-notification"),n=(0,g.default)("#challenge-input");e.removeClass(),a.text(t.message),"authentication_required"!==t.status?("incorrect"===t.status?(e.addClass("alert alert-danger alert-dismissable text-center"),e.slideDown(),n.removeClass("correct"),n.addClass("wrong"),setTimeout(function(){n.removeClass("wrong")},3e3)):"correct"===t.status?(e.addClass("alert alert-success alert-dismissable text-center"),e.slideDown(),(0,g.default)(".challenge-solves").text().trim()&&(0,g.default)(".challenge-solves").text(parseInt((0,g.default)(".challenge-solves").text().split(" ")[0])+1+" Solves"),n.val(""),n.removeClass("wrong"),n.addClass("correct")):"already_solved"===t.status?(e.addClass("alert alert-info alert-dismissable text-center"),e.slideDown(),n.addClass("correct")):"paused"===t.status?(e.addClass("alert alert-warning alert-dismissable text-center"),e.slideDown()):"ratelimited"===t.status&&(e.addClass("alert alert-warning alert-dismissable text-center"),e.slideDown(),n.addClass("too-fast"),setTimeout(function(){n.removeClass("too-fast")},3e3)),setTimeout(function(){(0,g.default)(".alert").slideUp(),(0,g.default)("#challenge-submit").removeClass("disabled-button"),(0,g.default)("#challenge-submit").prop("disabled",!1)},3e3)):window.location=c.default.config.urlRoot+"/login?next="+c.default.config.urlRoot+window.location.pathname+window.location.hash}function C(){v.map(function(e){e.solved_by_me&&((e=(0,g.default)('button[value="'.concat(e.id,'"]'))).addClass("solved-challenge"),e.prepend("<i class='fas fa-check corner-button-check'></i>"))})}function k(e){return c.default.api.get_challenge_solves({challengeId:e}).then(function(e){var t=e.data;(0,g.default)(".challenge-solves").text(parseInt(t.length)+" Solves");var a=(0,g.default)("#challenge-solves-names");a.empty();for(var n=0;n<t.length;n++){var l=t[n].account_id,o=t[n].name,s=(0,r.default)(t[n].date).fromNow(),d=t[n].account_url;a.append('<tr><td><a href="{0}">{2}</td><td>{3}</td></tr>'.format(d,l,(0,i.htmlEntities)(o),s))}})}function _(){return c.default.api.get_challenge_list().then(function(e){var t=[],a=(0,g.default)("#challenges-board");v=e.data,a.empty();for(var n,l,o=v.length-1;0<=o;o--)-1==g.default.inArray(v[o].category,t)&&(n=v[o].category,t.push(n),l=n.replace(/ /g,"-").hashCode(),(l=(0,g.default)('<div id="{0}-row" class="pt-5">'.format(l)+'<div class="category-header col-md-12 mb-3"></div><div class="category-challenges col-md-12"><div class="challenges-row col-md-12"></div></div></div>')).find(".category-header").append((0,g.default)("<h3>"+n+"</h3>")),a.append(l));for(var s=0;s<=v.length-1;s++){for(var d=v[s],i=d.name.replace(/ /g,"-").hashCode(),r=d.category.replace(/ /g,"-").hashCode(),c=(0,g.default)("<div id='{0}' class='col-md-3 d-inline-block'></div>".format(i)),u=void 0,u=-1==m.indexOf(d.id)?(0,g.default)("<button class='btn btn-dark challenge-button w-100 text-truncate pt-3 pb-3 mb-2' value='{0}'></button>".format(d.id)):(0,g.default)("<button class='btn btn-dark challenge-button solved-challenge w-100 text-truncate pt-3 pb-3 mb-2' value='{0}'><i class='fas fa-check corner-button-check'></i></button>".format(d.id)),f=(0,g.default)("<p>{0}</p>".format(d.name)),i=(0,g.default)("<span>{0}</span>".format(d.value)),h=0;h<d.tags.length;h++){var p="tag-"+d.tags[h].value.replace(/ /g,"-");c.addClass(p)}u.append(f),u.append(i),c.append(u),(0,g.default)("#"+r+"-row").find(".category-challenges > .challenges-row").append(c)}(0,g.default)(".challenge-button").click(function(e){b(this.value)})})}function j(){v.forEach(function(a){w(a.id,function(e){var t=(0,g.default)('button[value="'.concat(a.id,'"]'));t.removeClass("running-challenge"),t.removeClass("stopping-challenge"),t.find("i.corner-button-play").remove(),t.find("i.corner-button-stop").remove(),"started"===e.state||"starting"===e.state?(t.addClass("running-challenge"),t.append("<i class='fas fa-play corner-button-play'></i>")):"stopping"===e.state&&(t.addClass("stopping-challenge"),t.append("<i class='fas fa-stop corner-button-stop'></i>"))})})}function x(){return _().then(C).then(j)}(0,g.default)(function(){x().then(function(){var e,t,a;0<window.location.hash.length&&(e=decodeURIComponent(window.location.hash.substring(1)),t=e.lastIndexOf("-"),a=[e.slice(0,t),e.slice(t+1)][1],t=g.default.grep(v,function(e){return e.id==a})[0],d(t))}),(0,g.default)("#challenge-input").keyup(function(e){13==e.keyCode&&(0,g.default)("#challenge-submit").click()}),(0,g.default)(".nav-tabs a").click(function(e){e.preventDefault(),(0,g.default)(this).tab("show")}),(0,g.default)("#challenge-window").on("hidden.bs.modal",function(e){(0,g.default)(".nav-tabs a:first").tab("show"),history.replaceState("",window.document.title,window.location.pathname)}),(0,g.default)(".challenge-solves").click(function(e){k((0,g.default)("#challenge-id").val())}),(0,g.default)("#challenge-window").on("hide.bs.modal",function(e){(0,g.default)("#challenge-input").removeClass("wrong"),(0,g.default)("#challenge-input").removeClass("correct"),(0,g.default)("#incorrect-key").slideUp(),(0,g.default)("#correct-key").slideUp(),(0,g.default)("#already-solved").slideUp(),(0,g.default)("#too-fast").slideUp()})}),setInterval(x,3e5);function T(e){(0,n.ezAlert)({title:"Hint",body:e.html,button:"Got it!"})}var S=function(a){c.default.api.get_hint({hintId:a}).then(function(e){var t;e.data.content?T(e.data):(t=a,(0,n.ezQuery)({title:"Unlock Hint?",body:"Are you sure you want to open this hint?",success:function(){c.default.api.post_unlock_list({},{target:t,type:"hints"}).then(function(e){e.success?c.default.api.get_hint({hintId:t}).then(function(e){T(e.data)}):(0,n.ezAlert)({title:"Error",body:e.errors.score,button:"Got it!"})})}}))})}}});